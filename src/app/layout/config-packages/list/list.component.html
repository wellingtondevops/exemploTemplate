<div [@routerTransition]>
    <ngx-loading [show]="loading" [config]="{
      backdropBorderRadius: '3px',
      fullScreenBackdrop: true,
      primaryColour: '#222',
      secondaryColour: '#222',
      tertiaryColour: '#222'
  }"></ngx-loading>
    <div class="card  mb-3">
        <div class="card-header" id="step1">
            <div class="row mt-0">
                <div class="col-lg-12 text-right">
                    <i class="mdi mdi-help-circle mdi-24px" style="color:#2869D9;" (click)="help()"></i>
                </div>
            </div>
            <app-page-header [heading]="'Pacotes'" [modalNew]="true" [icon]="'fa-table'" [btnNew]="'Novo Pacote'"
                (click)="newPackage($event)" [permissionBtnNew]="permissionNew">
            </app-page-header>
        </div>
        <div class="card-body">
            <form [formGroup]="searchForm" (ngSubmit)="setPagePackages(page)" role="FormGroup">
                <div class="row" id="step2">
                    <div class="form-group mb-2 col-lg-7 col-sm-12">
                        <label for="labelName">Nome do Pacote</label>
                        <input id="labelPackage" autoFocus="true" type="text" placeholder="Nome do Pacote"
                            class="form-control" formControlName="labelPackage" style="width: 100%"
                            [ngClass]="{ 'is-invalid': labelPackage.invalid && labelPackage.touched }" />
                        <div *ngIf="labelPackage.invalid && (labelPackage.dirty || labelPackage.touched)"
                            class="invalid-feedback">
                            <div *ngIf="!labelPackage.valid">
                                Nome do Pacote é obrigatório.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" id="step3">
                    <div class="form-group mb-2 col-lg-12 col-sm-12 text-center">
                        <button type="submit" class="btn btn-primary" [disabled]="labelPackage.invalid">
                            <i class="fa fa-search"></i>
                        </button>
                        <button type="submit" class="btn dark-btn" style="margin-left: 5px;"
                            [disabled]="labelPackage.invalid" (click)="clear()">
                            Limpar Campos
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div id="step4">
        <ngx-datatable #myTable class="bootstrap" [rows]="packages.items" [columnMode]="ColumnMode.force"
            [scrollbarH]="true" [headerHeight]="50" [footerHeight]="50" rowHeight="auto" [externalPaging]="true"
            [count]="page.totalElements" [offset]="page.pageNumber" [limit]="10" (page)='setPagePackages($event)'
            (activate)="getPackages($event)">
            <ngx-datatable-column name="Nome do Pacote" prop="labelPackage"></ngx-datatable-column>

            <ngx-datatable-column name="OCR" prop="ocr">
                <ng-template let-value="value" ngx-datatable-cell-template>
                    <ng-container *ngIf="value === true; else elseTemplate">
                        <abbr title="Possui OCR">
                            <i class="mdi mdi-ocr mdi-24px"></i>
                        </abbr>
                    </ng-container>
                    <ng-template #elseTemplate>
                        <abbr title="nNão possui OCR">
                            <i class="mdi mdi-ocr-outline mdi-24px"></i>
                        </abbr>
                    </ng-template>
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Assinatura Digital" prop="signature">
                <ng-template let-value="value" ngx-datatable-cell-template>
                    <ng-container *ngIf="value == true; else elseTemplate">
                        <abbr title="Possui assinatura digital">
                            <i class="mdi mdi-signature mdi-24px"></i>
                        </abbr>
                    </ng-container>
                    <ng-template #elseTemplate>
                        <abbr title="Não ossui assinatura digital">
                            <i class="mdi mdi-alpha-c-circle-outline mdi-24px"></i>
                        </abbr>
                    </ng-template>
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Criado em" prop="dateCreated">
                <ng-template let-value="value" ngx-datatable-cell-template>
                    {{ value | date: 'dd/MM/yyyy' }}
                </ng-template>
            </ngx-datatable-column>
        </ngx-datatable>
    </div>
</div>